# Step-by-Step guide: Data-cleaning features in spreadsheets

Example 1: Use conditional formatting to highlight blank cells (**Format > Conditional formatting**)

Example 2: Remove duplicates after creating a copy of the data using **Data > Data cleanup > Remove duplicates**

Example 3: Format dates consistently using **Format > Number > Date**

Example 4: Use split to separate data into columns using **Data > Split text to columns**

Example 5: Use SPLIT function to fix numbers stored as text using **Data > Split text to columns**

# Step-by-Step: Optimize the data-cleaning process

**Example 1: The COUNTIF function:** returns the number of cells within a range that match a specified value. eg. Use **COUNTIF** to find numbers lower than 100

**Example 2: The LEN function**: The LEN function is useful if you have a certain piece of information in your spreadsheet that you know must contain a certain length.

**Example 3: Use conditional formatting**: Conditional formatting is a spreadsheet tool that changes how cells appear when values meet specific conditions. **Format > Conditional Formatting**

**Example 4: The LEFT and RIGHT functions:** LEFT is a function that returns a set number of characters from the left side of a text string. RIGHT is a function that returns a set number of characters from the right side of a text string.

**Example 5: The MID function**: MID is a function that returns a segment from the middle of a text string. =MID(D2, 4, 2) to extract the two-letter that starts at character four in cell **D2**.

**Example 6: The CONCATENATE function:** CONCATENATE is a spreadsheet function that joins together two or more text strings. =CONCATENATE(H2, I2)

**Example 7: TRIM function:** TRIM is a function that removes leading, trailing, and repeated spaces in data.

# Step-by-Step: Different data perspectives

**Example 1: Pivot tables**

A pivot table is a data summarization tool. It can be used in data processing and in data cleaning, for which pivot tables offer a quick, clutter-free view of your data. Pivot tables help sort, reorganize, group, count, total, or average data in a dataset. **Insert > Pivot Table**. Choose **New sheet** and **Create**. Google Sheets creates a new sheet where you can define the pivot table.

**Example 2: VLOOKUP**

VLOOKUP is a spreadsheet function that vertically searches for a certain value in a column to return a corresponding piece of information. It's rare for all of the data an analyst will need to be in the same place. Usually, you'll have to search across multiple sheets or even different databases. VLOOKUP helps bring the information together.

**=VLOOKUP(A2, 'Sheet 2'!A1:B31, 2, false)**

This formula will take the value in cell **A2** of **Sheet 1** and check for that value in **Sheet 2** among the cells from **A1:B31** in the 2nd column (which corresponds with the 2 in the formula). Because the formula includes “false,” it will search only for an exact match. It will then output the value of column **B** in Sheet 2 as the result.

**Example 3: Plotting**

The plotting tool allows analysts to quickly create a graph, chart, table, or other visual from data. Plotting is useful for identifying skewed data or outliers. **Insert > Chart**.

# Step-by-Step: Even more data-cleaning techniques

**Example: CONCATENATE**

CONCATENATE is a function that joins together two or more text strings. In the video, you’ll learn how to use CONCATENATE to clean data after two datasets have been combined. =CONCATENATE (D2,E2)

# Develop your approach to cleaning data

As you continue on your data journey, you’re likely discovering that data is often messy—and you can expect raw, primary data to be imperfect. In this reading, you’ll consider how to develop your personal approach to cleaning data. You will explore the idea of a cleaning checklist, which you can use to guide your cleaning process. Then, you’ll define your preferred methods for cleaning data. By the time you complete this reading, you’ll have a better understanding of how to methodically approach the data cleaning process. This will save you time when cleaning data and help you ensure that your data is clean and usable.

## Consider your approach to cleaning data

Data cleaning usually requires a lot of time, energy, and attention. But there are two steps you can take before you begin to help streamline your process: creating a cleaning checklist and deciding on your preferred methods. This will help ensure that you know exactly how you want to approach data cleaning and what you need to do to be confident in the integrity of your data.

### **Your cleaning checklist**

Start developing your personal approach to cleaning data by creating a checklist to help you identify problems in your data efficiently and identify the scale and scope of your dataset. Think of this checklist as your default “what to search for” list.

Here are some examples of common data cleaning tasks you could include in your checklist:

* **Determine the size of the dataset:** Large datasets may have more data quality issues and take longer to process. This may impact your choice of data cleaning techniques and how much time to allocate to the project.
* **Determine the number of categories or labels:** By understanding the number and nature of categories and labels in a dataset, you can better understand the diversity of the dataset. This understanding also helps inform data merging and migration strategies.
* **Identify missing data:** Recognizing missing data helps you understand data quality so you can take appropriate steps to remediate the problem. Data integrity is important for accurate and unbiased analysis.
* **Identify unformatted data:** Identifying improperly or inconsistently formatted data helps analysts ensure data uniformity. This is essential for accurate analysis and visualization.
* **Explore the different data types:** Understanding the types of data in your dataset (for instance, numerical, categorical, text) helps you select appropriate cleaning methods and apply relevant data analysis techniques.

There might be other data cleaning tasks you’ve been learning about that you also want to prioritize in your checklist. Your checklist is an opportunity for you to define exactly what you want to remember about cleaning your data; feel free to make it your own.

### **Your preferred cleaning methods**

In addition to creating a checklist, identify which actions or tools you prefer using when cleaning data. You’ll use these tools and techniques with each new dataset—or whenever you encounter issues in a dataset—so this list should be compatible with your checklist.

For example, suppose you have a large dataset with missing data. You’ll want to know how to check for missing data in larger datasets, and how you plan to handle any missing data, before you start cleaning. Outlining your preferred methods can save you lots of time and energy.

# Advanced functions for speedy data cleaning

In this reading, you will learn about some advanced functions that can help you speed up the data cleaning process in spreadsheets. Below is a table summarizing three functions and what they do:

![A table listing the primary use of 3 advanced functions, IMPORTRANGE, QUERY, and FILTER in Google Sheets and MicroSoft Excel](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/ulCbsJFoS9erYrW-Sr1I_Q_d2f1f7fa0ac34bbc8b9c12e0fdf92ef1_Screenshot-2023-11-17-3.16.09-PM.png?expiry=1750896000000&hmac=-Nt0gHmr-KilrKSvcrlvLRU4FaMdCuhY-Pe09wEtk3c)

## Keeping data clean and in sync with a source

The [**IMPORTRANGE**](https://support.google.com/docs/answer/3093340?hl=en) function in Google Sheets and the [**Paste Link**](https://professor-excel.com/how-to-paste-cell-links/ "Paste Link") feature (a Paste Special option in Microsoft Excel) both allow you to insert data from one sheet to another. Using these on a large amount of data is more efficient than manual copying and pasting. They also reduce the chance of errors being introduced by copying and pasting the wrong data. They are also helpful for data cleaning because you can “cherry pick” the data you want to analyze and leave behind the data that isn’t relevant to your project. Basically, it is like canceling noise from your data so you can focus on what is most important to solve your problem. This functionality is also useful for day-to-day data monitoring; with it, you can build a tracking spreadsheet to share the relevant data with others. The data is synced with the data source so when the data is updated in the source file, the tracked data is also refreshed.

In Google Sheets, you can use the IMPORTRANGE function. It enables you to specify a range of cells in the other spreadsheet to duplicate in the spreadsheet you are working in. You must allow access to the spreadsheet containing the data the first time you import the data.

**The URL shown below is for syntax purposes only. Don't enter it in your own spreadsheet. Replace it with a URL to a spreadsheet you have created so you can control access to it by clicking the Allow access button.**

![This image shows the #REF error and the message, "Error Spreadsheet cannot be found." because access is not yet allowed.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/MSGojhA_QaWhqI4QP5GlqA_1847a3dfdf7f4221aa3e9fefa55f06f1_Screenshot-2022-05-19-2.42.39-PM.png?expiry=1750896000000&hmac=1FSkdYH0sGs6g0_5g0IOCgJKb-e2XYt7jY-l1c-BSus)

Refer to the [Google support page for IMPORTRANGE](https://support.google.com/docs/answer/3093340?hl=en# "Google support page for IMPORTRANGE") for the sample usage and syntax.

### **Example of using IMPORTRANGE**

An analyst monitoring a fundraiser needs to track and ensure that matching funds are distributed. They use IMPORTRANGE to pull all the matching transactions into a spreadsheet containing all of the individual donations. This enables them to determine which donations eligible for matching funds still need to be processed. Because the total number of matching transactions increases daily, they simply need to change the range used by the function to import the most up-to-date data.

On Tuesday, they use the following to import the donor names and matched amounts:

=IMPORTRANGE("https://docs.google.com/spreadsheets/d/abcd123abcd123", "sheet1!A1:C10", "Matched Funds!A1:B4001")

On Wednesday, another 500 transactions were processed. They increase the range used by 500 to easily include the latest transactions when importing the data to the individual donor spreadsheet:

=IMPORTRANGE("https://docs.google.com/spreadsheets/d/abcd123abcd123", "Matched Funds!A1:B4501")

**Note: The above examples are for illustrative purposes only. Don't copy and paste them into your spreadsheet. To try it out yourself, you will need to substitute your own URL (and sheet name if you have multiple tabs) along with the range of cells in the spreadsheet that you have populated with data.

## Pulling data from other data sources

The [**QUERY**](https://support.google.com/docs/answer/3093343?hl=en "QUERY") function is also useful when you want to pull data from another spreadsheet. The QUERY function's SQL-like ability can extract specific data within a spreadsheet. For a large amount of data, using the QUERY function is faster than filtering data manually. This is especially true when repeated filtering is required. For example, you could generate a list of all customers who bought your company’s products in a particular month using manual filtering. But if you also want to figure out customer growth month over month, you have to copy the filtered data to a new spreadsheet, filter the data for sales during the following month, and then copy those results for the analysis. With the QUERY function, you can get all the data for both months without a need to change your original dataset or copy results.

The QUERY function syntax is similar to IMPORTRANGE. You enter the sheet by name and the range of data that you want to query from, and then use the SQL SELECT command to select the specific columns. You can also add specific criteria after the SELECT statement by including a WHERE statement. But remember, all of the SQL code you use has to be placed between the quotes!

Google Sheets run the Google Visualization API Query Language across the data. Excel spreadsheets use a query wizard to guide you through the steps to connect to a data source and select the tables. In either case, you are able to be sure that the data imported is verified and clean based on the criteria in the query.

### **Examples of using QUERY**

Check out the [Google support page for the QUERY function](https://support.google.com/docs/answer/3093343?hl=en "Google Support page for the QUERY function") with sample usage, syntax, and examples you can download in a Google sheet.

Link to make a copy of the sheet: [QUERY examples](https://docs.google.com/spreadsheets/d/1815H5TCe91LLT6tD6FmxMHmeJAAkr4o5Q6rNpV6xiFk/copy "examples of using the QUERY function")

### **The solution**

Analysts can use SQL to pull a specific dataset into a spreadsheet. They can then use the QUERY function to create multiple tabs (views) of that dataset. For example, one tab could contain all the sales data for a particular month and another tab could contain all the sales data from a specific region. This solution illustrates how SQL and spreadsheets are used well together.

## Filtering data to get what you want

The [**FILTER**](https://support.google.com/docs/answer/3093197?hl=en "FILTER") function is fully internal to a spreadsheet and doesn’t require the use of a query language. The FILTER function lets you view only the rows (or columns) in the source data that meet your specified conditions. It makes it possible to pre-filter data before you analyze it.

The FILTER function might run faster than the QUERY function. But keep in mind, the QUERY function can be combined with other functions for more complex calculations. For example, the QUERY function can be used with other functions like SUM and COUNT to summarize data, but the FILTER function can't.

### **Example of using FILTER**

Check out the [Google support page for the FILTER function](https://support.google.com/docs/answer/3093197?hl=en "Google Support page for the FILTER function") with sample usage, syntax, and examples you can download in a Google sheet.

Link to make a copy of the sheet: [FILTER examples](https://docs.google.com/spreadsheets/d/1caULJLQvQuzBnCN7rO9utg0xSKrYms7wM0Ph7A2JXY4/copy "FILTER examples")
